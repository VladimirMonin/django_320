## Занкомство с Django

### Что такое MTV?
1. Паттерн MTV
Models - Модели - классы, которые описывают структуру данных, которые будут храниться в базе данных.

Views - Вью - классы или функции, которые обрабатывают запросы и возвращают ответы.

Templates - Шаблоны - файлы, которые содержат HTML-код, который будет отправлен клиенту.

### Установка Django

Установили Django и обновили requirements.txt
```bash
pip install django
pip freeze > requirements.txt
```

Создали проект Django
```bash
django-admin startproject python_blog .
```
Создали приложение. Точка - текущая директория.
Иначе Django создат поддиректорию с названием проекта.

Коммит: **Создание проекта Django**

Получаем Django ракету!
**Команда для запуска сервера**

```bash
python manage.py runserver
```

### Главная страница Django (Url -> View -> Template)

1. Создаем первое приложение в проекте

**Приложение** - это отдельный функционал, который вынесен в обособленную часть проекта. Имеет свою логику, свою структуру и свой функционал.

```bash
python manage.py startapp blog_app
```

Коммит: **Создание приложения blog_app**

2. Добавляем приложение в проект
В САМОМ НИЗУ ПОСЛЕ ВСЕХ СЛУЖЕБНЫХ ПРИЛОЖЕНИЙ
```python
INSTALLED_APPS = [
    'django.contrib.admin',
    ...
    'blog_app',

```

3. Cоздаем первое `view` - `index` в файле `views.py`

```python
from django.shortcuts import render, HttpResponse

# Index - функция, которая будет отдавать HttpResponse с текстом "Привет из Django!"
def index(request):
    return HttpResponse("Привет из Django!")
```

4. Прописываем маршруты в файле `urls.py`
   
```python
from blog_app.views import index

urlpatterns = [
    path('admin/', admin.site.urls),
    # path('', views.index),
    path('', index),
]
```

Коммит: **Создание первого view**

## Знакомство с Шаблонизатором Django

1. Создаём папку `templates` в директории `blog_app`
2. Размещаем в ней файл `index.html` (Простой HTML-файл с заголовком 1 уровня)
3. Изменяем `views.py`. Используя функцию `render` из `django.shortcuts` передаём в неё `request` и `index.html`

```python
from django.shortcuts import render


def index(request):
    return render(request, 'index.html')

```

Коммит: **Создание первого шаблона**

### Первая переменная шаблона

Добавили переменную `{{name}} в index.html`
Добавили передачу контекста в шаблон

```python
def index(request):
    context = {'name': 'Zigmund'}
    return render(request, 'index.html', context=context)
```

Коммит: **Создание первой переменной шаблона**

### Типы данных которые можно передавать в шаблон

Мы можем передать в контекст шаблона любой тип данных, который можно сериализовать в JSON.

- Строки
- Числа
- Списки
- Словари
- Объекты
- Вызовы методов
- Обращения по ключу или индексу к коллекциям

## Знакомство с концепцией конвертеров в Django

`Конвертер` в маршрутизации Django - это функция, которая принимает строку и возвращает объект.

Например мы можем из маршрута получить id поста или slug его заголовка и передать в функцию представления, которорая поищет данные в БД и вернет ответ.

**Типы конвертеров в Django**

- `<int:pk>` - принимает только целые числа (пример:: /posts/1/)
- `<slug:slug>` - принимает только строки, содержащие буквы, цифры, дефисы и подчеркивания (например, "my-slug-123")
- `<str:name>` - принимает любые не пустые строки (но останавливается на `/`) (пример: `http://127.0.0.1:8000/blog/`)
- `<uuid:uuid>` - принимает строку в формате UUID (пример: 123e4567-e89b-12d3-a456-426655440000)
- `<path:subpath>` - принимает строку, которая может содержать слеши (то есть любые символы, используемые в URL) (пример: /path/to/resource)

Для определения маршрута с конкретным конвертером используется следующий синтаксис:

```python
from django.urls import path

urlpatterns = [
    path('posts/<int:pk>/', views.post_detail, name='post_detail'),        # Маршрут с целочисленным идентификатором поста
    path('posts/<slug:slug>/', views.post_by_slug, name='post_by_slug'),   # Маршрут с slug заголовка поста
]
```

### Что такое `slug`?

`Slug` - это короткий фрагмент текста, который используется для идентификации объекта или страницы в URL. Он обычно состоит из букв, цифр и дефисов и используется для улучшения читаемости URL.

Его очень любят поисковики, так как он помогает им понять, что за страница находится по данному URL.

`Пирожки с мясом и картошкой` -> `pirozhki-s-myasom-i-kartoshkoi`

`234` -> `234` - Поисковый робот не поймет, что это за страница.

### Как это выглядит со стороны `View`?

```python
from django.shortcuts import render

def post_detail(request, slug):

    # Ищем пост в базе данных по slug
    pass
```
